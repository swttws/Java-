#### 一、计算机概述
##### 1、计算机网络层次模型
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666313870414-bc72013a-1ab4-41f9-a7cc-dddb801eba45.jpeg)
##### 2、计算机网络：
（1）由结点、链路，协议组成；
（2）协议：对等实体层通信应当遵守规则的集合，规范语法、语义、时序，如：linux上的实体，与安卓上的实体遵守统一协议，可以相互通信；
##### 3、网络结构
（1）网络结构原理图
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666317404847-15a66d31-b85e-418e-9543-ce63035c1916.jpeg)
（2）网络边缘
①端系统：运行的应用程序、在网络边缘；
②客户/服务器模式（C/S）：客户端发送请求，服务器响应请求，发送给客户端；
主从模式，服务器为主，存放所有资源，客户端为从；
③P2P（对等模式）：每个结点，即是客户端，也是服务器；
④面向连接通信服务：维护端系统连接；如TCP
可靠连接：端发送数据，另外一个端原原本本接收数据；
流量控制：根据接收方接收效率，控制发送方的数据发送速度；
拥塞控制：根据链路的堵塞状态，控制发送方的数据发送速度
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666318812021-f04d6ce3-1b08-4729-a26e-1a23e577ec97.jpeg)
⑤无连接服务（UDP）：不可靠，无流量、拥塞控制；
（3）网络核心
①电路（线路）交换：独享资源，连接一旦建立起来可以保证性能，若无数据发送，会浪费资源；
不适合计算机通信：建立连接时间长，资源浪费较多，可靠性不高；
②频分复用（FDN）、时分复用（TDN）、波分复用（WDM）
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666321217018-09f7235a-d75d-4c38-9107-6730d606c896.jpeg)
③分组交换：存储——转发
A、网络交换不再分为一个个片，传输时使用所有带宽；
B、将原吧own划分为一小块数据开，称为分组，以分组为单位，在每一个分组结点存储后，再转发；优点是实现网络共享；
C、排队延迟、路由器缓存用完，会使数据丢失（丢包）；
D、采用统计多路复用（时分复用的特殊）；
E、数据报网络：存储目标主机地址，通信时无须建立连接，有数据就传输，路由根据分组目标地址进行路由；
F、虚电路网络：须建立连接，中间经过的交换结点都需要建立连接；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666322355190-a2d924a7-f3dd-47db-b7f7-86341c8ee64b.jpeg)
④关键功能
路由：决定分组采用的源到目标路径，全局的；
转发：将分组从路由器的输入链路发送到输出链路，局部的；
（4）接入网和物理媒体
①住宅接入：modem
②接入网：线缆网络;
③无线接入网络：各无线端系统共享无线接入网络；
④物理媒体：
导引型媒体：看的到的媒体，双绞线、光纤、同轴电缆；
非导引型媒体：看不见的媒体
##### 4、Internet结构和ISP
（1）端系统通过ISP（网络服务提供商）接入网络；
（2）ICP：网络内容提供商，如谷歌搜索服务，通过ISP接入网络；
（3）IXP：多个对等ISP互联互通，不涉及费用结算；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666401710545-571040e9-e84c-490d-bc5e-593313ac92dd.jpeg)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/29496365/1666798325212-5b449fba-faae-4ad7-a95e-eba34067cbe0.png#averageHue=%23cacaca&clientId=ue729837f-cd2a-4&from=paste&height=249&id=u8e8447b1&name=image.png&originHeight=374&originWidth=891&originalType=binary&ratio=1&rotation=0&showTitle=false&size=198695&status=done&style=none&taskId=u0a513a11-3bb7-4817-ab3d-0e2e3c2020f&title=&width=594)
##### 5、分组延时、丢失、吞吐量
（1）丢失：分组达到链路的速率超出了链路的输出能力，进入路由器缓冲队列，路由器缓冲区队列大小有限，当达到队列最大时，会丢失数据；
（2）延迟：
①处理延迟：检查分组的首部和决定将分组分向何处；
②排队延迟：在输出链路上等待传输，与路由器拥塞程度有关；
③传播延迟：链路上传播的延迟；
④传输延迟：路由器转发数据的时间延迟；
（3）吞吐量：源端和目标端之间的传输速率；
##### 6、协议层次及服务模型
（1）服务访问点（SAP）：层间服务中，服务提供者通过服务访问点服务对应的用户；
（2）原语：服务提供者向服务用户提供服务的形式；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666406912050-c921dc5b-2c27-42fe-94ed-78687d44c9a2.jpeg)
（3）服务域协议关系：对等层之间的协议借助下层来实现，为上层提供更好的服务；
（4）SDU：数据单元
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666411910053-1c38ef24-2ded-44f0-82fc-d4e3698533e1.jpeg)
（5）Internet层次
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666413964088-afefd7df-54de-46a9-9cbe-58453d57d78f.jpeg)

#### 二、应用层
##### 1、应用层原理
（1）客户——服务器（C/S）体系结构
①服务器：固定端口和IP一直运行，扩展性差；
②客户端：主动与服务器通信，IP可能是动态ip，不直接与其他客户端通信。
（2）P2P体系结构
①没有一直运行服务器，每一个结点既是服务器，又是客户端；
②任意端系统之间可以相互通信；如即时通信聊天
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666418474839-ea715e2e-fde7-4581-a140-ef42a8e9ce62.jpeg)
（3）进程接收报文，需要有标识：
    ①唯一的32位IP地址；②采用的传输协议TCP or UDP；③端口号。
（4）应用层须将要传输的报文（SDU）、谁传的（IP+端口）、传输目标（IP+端口）传输给层间接口（SPA），传输层进行封装。
（5）TCP socket：
①TCP服务：两个进程通信需要建立连接；
②可以用一个整数表示应用实体间的关系，本地标识；
③穿过层间接口的信息量最少；
④socket：源IP，源端口，目标IP，目标端口；
##### 2、Web和HTTP
（1）HTTP：超文本传输协议，运行在TCP之上
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666425194002-d826c595-af92-4b1c-af6f-1c823ac1cc5c.jpeg)
（1）TCP建立连接过程
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666425748474-2920f93c-b11c-43e2-bdc6-34979f228686.jpeg)
（3）HTTP为无状态的：服务器不维护关于客户端的任何信息；
（4）非持久HTTP和持久化HTTP
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666426772457-a25cc464-16b0-4f05-bbbe-172e4b8b5e2c.jpeg)
（5）HTTP请求报文
①HTTP报文类型：请求和响应；
②格式：
请求行（GET、POST、HEAD，PUT、DELETE命令）：url，http版本，命令
首部行：首部值，名称，user-agent用户代理
实体行（可能没有）
（6）HTTP响应报文
①状态行：协议、版本号，状态码；
②首部行：Last-Modified版本，Content-length内容长度，Content-type内容类型，server服务器类型
③数据，请求
（7）HTTP响应状态码
①301：请求对象已被永久移除；
②400：请求无法被服务器解读；
③404：服务器找不到；
④505：版本号不支持；
（8）用户-服务器状态（cookies）
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666619250680-c82ae22f-d229-4abb-bd70-9f14c6ff9426.jpeg)
##### 3、FTP
（1）向远程主机上传文件或接收文件；
（2）守候端口21；
（3）有状态协议；
#### 4、EMail
（1）组成部分：用户代理、邮件服务器、简单传输协议SMTP；
（2）SMTP：
①三个阶段：握手、传输报文、关闭；
②使用TCP在客户端与服务端之间发送报文，端口为25；
③持久连接，报文为ASCII码范围；
（3）IMAP邮件访问协议：远程目录维护
##### 5、DNS
（1）主要思路：
①分层的，基于域的命名；
②若干分布式数据库存储ip以及对应域名；
③运行在UDP之上的53端口；
（2）目的：
①实现主机名——IP地址的转换；
②主机别名到规范名字的转换；
③负载均衡；
（3）解析过程
①应用调用解析器；
②解析器作为客户，向Name Server发出查询报文（封装在UDP中）；
③Name Server返回响应报文；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666443436812-641447c0-8fcc-4fb6-a241-5239f19e80d6.jpeg)
##### 6、P2P应用
（1）文件分发
①服务器传输：最少需要上载一份拷贝；
②客户端：每个客户端必须下载一份进行拷贝；
③BitTorrent：
（2）非结构化P2P
【1】集中式目录
①客户端上线，告知中心服务器其ip地址，内容；
②存在问题：单点故障、性能瓶颈、侵权版权；
【2】完全分布式
①没有中心服务器
【3】BitTorrent：
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666491097316-127dca44-168b-4c25-840b-e68affd4f077.jpeg)
##### 7、CDN
（1）全网部署缓存结点，存储服务内容，就近为用户提供服务，提高用户体验；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666498189658-c00659da-8b2f-4a4d-8850-195939e39509.jpeg)
（2）CDN在应用层上运行，运行在网络边缘；
##### 8、TCP、UDP套接字
（1）套接字：应用进程与端到端协议的门户；
（2）TCP套接字编程：
①服务器必须处于运行状态，创建socket，与本地端口进行绑定；
②客户端创建socket，绑定客户端端口，指定服务器ip与端口，进行连接；
③当与客户端连接请求到来时，服务器socket接触阻塞状态，返回新的socket，与客户端通信；
④连接API调用时，客户端与服务端建立TCP连接；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666503433498-81775a99-4c02-4eac-b600-f9edfa6e201c.jpeg)
（3）UDP套接字
①客户端与服务端之间没有连接，没有握手；
②发送端每一个报文明确指定接收端IP和端口；
③服务端需要从分组中提取发送端的IP和端口；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666504808738-c813eeaa-cb8b-4ba9-834f-c996d42ff65b.jpeg)

#### 三、传输层
##### 1、传输层服务
（1）进程之间的逻辑通信；
（2）依赖于网络层，延迟，带宽；
（3）对网络层服务端增强，提高可靠传输；
##### 2、多路复用和解复用
（1）在发送方主机复用：从多个socket接收来自多个进程的报文，根据socket对应的IP地址和端口号等信息对报文段头部加以封装（该头部信息用于解复用）；
（2）在接收方主机解复用：根据报文段头部对应的IP地址和端口号将接收的报文段发给正确的socket和对应应用进程；
##### 3、无连接UDP（用户数据报协议）
（1）UDP发送端和接收端没有握手，无连接状态；
（2）每个UDP报文都被独立的处理；
（3）UDP常用于流媒体应用；
（4）无拥塞控制和流量控制，传输速度快；
##### 4、可靠数据传输（rdt）原理
（1）可靠传输：数据不丢失，不重复，不失去；
（2）停止等待确认协议：发送分组，等待回应后再发送下一个分组
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666665298847-9977694c-2257-4718-9a20-d828bef5abd2.jpeg)
（3）rdt2.1
①发送方：分组中加入序列号，序列号用01表示，必须检测ACK或NAK是否出错；
②接收方：必须检测接收到的分组是否重复，状态会提示0或1；接收方无法确认发送方是否接收到ACK或NAK；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666666224234-6cb8f37e-d2d1-4018-86e8-7c267387377c.jpeg)
（4）rdt2.2：具有处理差错检测
①无NAK的协议；
②接收方对最后正确的分组发ACK，接收方必须对ACK做编号；
③当重复接收到ACK，重传分组；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666667425332-f107e980-2485-4183-91b9-20f176a2828c.jpeg)
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666667521436-38acc513-8cf7-4bf3-95ab-0ec1af350a5d.jpeg)
（5）rdt3.0：可以解决分组丢失和检测差错
①超时重传机制；如果没有收到ACK，一定时间后，会重传；
②同时具有rdt2.2的功能；
③采用停止等待协议，效率不高；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666668566729-0522d4a6-0493-49b4-8915-b3f0d8e02a21.jpeg)
（6）流水线协议：运行发送方在未得到对方确认情况下，一次发送多个分组
【1】发送缓冲区：用于存放已经发送，但未得到确认的分组，分组只有得到确认才可删除；
【2】发送窗口：
①新分组落入发送缓冲区，发送分组——前沿滑动；
②来了老的序号的分组确认：后沿向前滑动——新的分组可以落入发送缓冲区；
【3】接收窗口：收到分组，落入窗口范围，接收；最低序号，发送确认给发送方；
【4】GBN（回退N帧协议）
①接收窗口的值为1，只能顺序接收分组；
②分组乱序到达接收方，接收方无法识别分组，丢弃，发送方时间到后，重传所有已发送的分组给接收方；
③累计确认；
【5】选择重传协议（SR）
①每发送一个分组，会启动超时定时器，确认后，关闭定时器；
②接收窗口值>1，乱序接收；
③单个确认；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666843432120-32b84a2e-4253-4190-9339-bfa71c19fca1.jpeg)
##### 5、面向对象连接TCP
（1）TCP序列号Seq和确认号ACK
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666845395911-9df634c7-bddd-470d-a866-d9bb7227fde3.jpeg)
（2）TCP可靠传输（GBN+SR）
【1】ack=n，表示n之前的分组已经接收到，且期待下一个确认的分组号为n；
【2】只会给最老的分组设置一个定时器，重传只会重传该分组；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666847476677-debbea5f-6658-4982-bbda-b389a12db158.jpeg)
【3】ACK发送情况
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666848641502-0a86810b-66d3-43c8-bf57-8153c8b79d34.jpeg)
【4】快速重传：重复接收相同ack多次，重传该分组；
【5】流量控制：接收方控制发送方，让发送方不要发得太快；接收方通过捎带技术，将主机的空闲缓冲区大小发送给发送方；
（3）TCP连接管理
【1】三次握手连接
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666851481327-79d914d9-848d-4501-91ae-6e2e16067035.jpeg)
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1666851721903-ce43c4ee-8508-4a35-a138-d06712f4b1c7.jpeg)
【2】连接释放：客户端和服务端分别关闭自己一侧的连接
（4）TCP拥塞控制
【1】拥塞感知：
①缓冲区用完，数据丢失，超时重传；
②三个冗余ACK，网络发生拥塞；
【2】拥塞控制策略
①慢启动

#### 四、网络层
##### 1、网络层服务
（1）在发送主机和接收主机之间传送段；
（2）在发送端将数据封装到数据报；
（3）在接收方将段交给传输层实体；
（4）网络层协议存储在主机和路由器中；
（5）路由器检查每一个经过它的IP的头部；
（6）路由：从源到目的主机的路径；
（7）转发：将分组从输入接口转发到合适的输出端口；
##### 2、IP协议
（1）IP分片和重组
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667097281060-4a2b750f-7976-498a-a6a0-7a71a177841e.jpeg)
（2）子网
①一个子网内的节点，他们的IP地址高位部分相同，这些节点的网络构成的网络为子网；
②无需路由器接入，各主机可在物理上相互直接到达；
③无类域间路由（CIRD）：
【1】地址格式：a.b.c.d/x，x为地址中子网号长度；
【2】子网部分可以在任意位置；
（3）DHCP动态主机配置协议
①允许主机加入网络时。动态从服务器获取IP地址；
②工作原理：主机广播DHCP服务，DHCP服务器提供报文响应，主机请求IP地址，DHCP服务器发送地址；
③DHCP作用于UDP之上。
（4）路由通告
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667106070752-be50fc52-ce3e-4b36-b4cc-6815e3552f4f.jpeg)
(5)NAT路由器
①外出数据包：替换原地址和端口号为NAT IP地址和新端口号，目标IP地址和端口号不变；
②NAT转换表：记录每个替换对，源IP，端口——NAT IP地址，新端口；
③进入数据包：替换目标IP地址和端口号。
④NAT穿透：外网设备主动发起请求，需要访问NAT后的内网服务
【1】静态配置NAT：转发进来的对服务器特定端口的连接请求；
【2】UPNP协议：允许NAT主机查询NAT表项；
【3】中继：内网设备主动与中继连接。
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1668991296917-63629762-7e35-4992-b230-5ad3f2158487.jpeg)
##### 3、路由选择算法
（1）链路路由选择算法
①路由器获取整个网络拓扑，网络中所有链路代价问题；
【1】发现相邻节点，获知对方网络地址；
【2】测量到相邻结点的代价（延迟，开销）；
【3】组装一个链路分组，描述相邻结点的代价；
【4】将链路分组扩散（泛洪）到所有其他路由器；
（扩散会导致广播风暴，可以通过设置TTL、设置标记）
②使用最短路由算法（迪杰斯特拉算法）获取路由表；
③使用路由表；
(2)距离矢量算法
本结点的邻居结点会告知其结点与其他邻居结点的距离，从而不断算出本结点通过邻居结点到下一个结点的最小值
##### 4、内部网关路由选择协议
（1）RIP（基于距离矢量算法）
①每隔30秒，相邻两个邻居相互交换距离矢量，通告；
②每个通告最多25个目标子网，最多16跳；
③180秒未收到通告，表明邻居结点宕机；
（2）OSPF（基于链路状态算法）
①通过信息携带：每个邻居路由器一个表项；
②通告信息会传遍AS全部（泛洪），在IP数据报直接传送OSPF报文；
##### 5、ISP之间路由选择协议：BGP（外部网关协议）
（1）eBGP：一个自治区域（AS）收集内部通告（可达子网信息），告知隔壁自治区域；
（2）iBGP：将获得子网可达信息传遍AS内部所有路由器；
（3）路由选择：
【1】根据策略决定；
【2】最少的跳数；
【3】评分一致，取代价较少的；

#### 五、数据链路层、物理层
##### 1、多点访问协议（介质访问控制协议：MAC）
（1）分类：
①信道划分协议
低负载时，信道利用率低，高负载，利用率高；
②随机存储协议
【1】时隙ALHOA：信道利用率低，时间需要同步
【2】非时隙ALHOA：当前有帧，立马传输；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667188210308-5b3f4e52-4663-4c48-8961-03af95a22709.jpeg)
③依次轮流协议
（2）CSMA/CD
①适配器获取数据报，创建帧；
②发送前，侦听信道CS，闲：开始发送帧，忙：等闲发送；
③发送过程中，冲突检测CD，没有冲突，则发送成功，冲突，放弃，之后重发；
④检测到冲突后，发送一个Jam信号，强化冲突；
⑤放弃后，进入退避状态；（自适应算法）
##### 2、LANs（链路层地址）
（1）LAN（MAC/物理/以太网）地址：用于使帧从一个网卡传递到另外一个网卡；
（2）ARP协议
①ARP表：包括LAN结点IP/MAC地址的映射；
②工作流程：发送一个广播数据报给各相邻结点，问相邻结点的MAC地址是什么，相邻结点插叙ARP表，查到的结点返回数据报，发送结点存储到栈表，20分钟后删除该映射关系（删除原因：IP地址与MAC地址对应映射可能是变化的）；
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667305584087-f48b99dd-d210-4056-a4f3-38bb0c870870.jpeg)
（3）以太网
①交换机：维护交换表，按照MAC地址转发
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667309475063-636e3531-5da2-4b3e-bbb7-4b608e59443d.jpeg)
②以太帧结构
![](https://cdn.nlark.com/yuque/0/2022/jpeg/29496365/1667307175729-9a42f5f2-7458-4189-941f-fabee2cf2694.jpeg)




